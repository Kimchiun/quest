4d9d9a1e79a8a665e56dc326e43dfec8
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createTestCaseWithVersion = createTestCaseWithVersion;
exports.updateTestCaseWithVersion = updateTestCaseWithVersion;
exports.deleteTestCaseWithIndex = deleteTestCaseWithIndex;
exports.getTestCaseVersions = getTestCaseVersions;
exports.getTestCases = getTestCases;
exports.getTestCaseById = getTestCaseById;
exports.createTestCase = createTestCase;
exports.updateTestCase = updateTestCase;
exports.deleteTestCase = deleteTestCase;
const testCaseRepository_1 = require("../repositories/testCaseRepository");
function omitFields(obj, keys) {
    const copy = { ...obj };
    keys.forEach(k => { delete copy[k]; });
    return copy;
}
async function createTestCaseWithVersion(tc) {
    const created = await (0, testCaseRepository_1.createTestCase)(tc);
    await (0, testCaseRepository_1.createTestCaseVersion)({
        testcaseId: created.id,
        version: 1,
        data: { ...tc },
        createdBy: tc.createdBy,
    });
    // Elasticsearch 인덱싱 임시 비활성화
    // await indexTestCase(created);
    return created;
}
async function updateTestCaseWithVersion(id, patch, user) {
    const before = await (0, testCaseRepository_1.getTestCaseById)(id);
    if (!before)
        return null;
    const updated = await (0, testCaseRepository_1.updateTestCase)(id, patch);
    if (!updated)
        return null;
    const versions = await (0, testCaseRepository_1.listTestCaseVersions)(id);
    await (0, testCaseRepository_1.createTestCaseVersion)({
        testcaseId: id,
        version: (versions[0]?.version || 1) + 1,
        data: omitFields(updated, ['id', 'createdAt', 'updatedAt']),
        createdBy: user,
    });
    // Elasticsearch 인덱싱 임시 비활성화
    // await indexTestCase(updated);
    return updated;
}
async function deleteTestCaseWithIndex(id) {
    const ok = await (0, testCaseRepository_1.deleteTestCase)(id);
    // Elasticsearch 인덱싱 임시 비활성화
    // if (ok) await removeTestCaseFromIndex(id);
    return ok;
}
async function getTestCaseVersions(id) {
    return (0, testCaseRepository_1.listTestCaseVersions)(id);
}
// 컨트롤러에서 사용할 메서드들
async function getTestCases(params) {
    const testCases = await (0, testCaseRepository_1.listTestCases)();
    // 간단한 필터링 (실제로는 repository에서 처리해야 함)
    let filteredCases = testCases;
    if (params.search) {
        filteredCases = filteredCases.filter(tc => tc.title.toLowerCase().includes(params.search.toLowerCase()) ||
            tc.prereq?.toLowerCase().includes(params.search.toLowerCase()) ||
            tc.expected?.toLowerCase().includes(params.search.toLowerCase()));
    }
    if (params.folderId) {
        filteredCases = filteredCases.filter(tc => tc.folderId === params.folderId);
    }
    // 페이징 처리
    const offset = (params.page - 1) * params.limit;
    const paginatedCases = filteredCases.slice(offset, offset + params.limit);
    return {
        testCases: paginatedCases,
        total: filteredCases.length
    };
}
async function getTestCaseById(id) {
    return await (0, testCaseRepository_1.getTestCaseById)(id);
}
async function createTestCase(data) {
    return await createTestCaseWithVersion(data);
}
async function updateTestCase(id, data) {
    return await updateTestCaseWithVersion(id, data, data.createdBy || 'system');
}
async function deleteTestCase(id) {
    return await deleteTestCaseWithIndex(id);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0RvY3VtZW50cy9xdWVzdC9EZXNrdG9wL3F1ZXN0L3NyYy9tYWluL2FwcC9kb21haW5zL3Rlc3RjYXNlcy9zZXJ2aWNlcy90ZXN0Q2FzZVNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7QUFVQSw4REFXQztBQUVELDhEQWVDO0FBRUQsMERBS0M7QUFFRCxrREFFQztBQUdELG9DQStCQztBQUVELDBDQUVDO0FBRUQsd0NBRUM7QUFFRCx3Q0FFQztBQUVELHdDQUVDO0FBbkdELDJFQUEwUTtBQUkxUSxTQUFTLFVBQVUsQ0FBc0MsR0FBTSxFQUFFLElBQVM7SUFDdEUsTUFBTSxJQUFJLEdBQUcsRUFBRSxHQUFHLEdBQUcsRUFBRSxDQUFDO0lBQ3hCLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsR0FBRyxPQUFRLElBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2hELE9BQU8sSUFBa0IsQ0FBQztBQUM5QixDQUFDO0FBRU0sS0FBSyxVQUFVLHlCQUF5QixDQUFDLEVBQW9EO0lBQ2hHLE1BQU0sT0FBTyxHQUFHLE1BQU0sSUFBQSxtQ0FBa0IsRUFBQyxFQUFFLENBQUMsQ0FBQztJQUM3QyxNQUFNLElBQUEsMENBQXFCLEVBQUM7UUFDeEIsVUFBVSxFQUFFLE9BQU8sQ0FBQyxFQUFFO1FBQ3RCLE9BQU8sRUFBRSxDQUFDO1FBQ1YsSUFBSSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDZixTQUFTLEVBQUUsRUFBRSxDQUFDLFNBQVM7S0FDMUIsQ0FBQyxDQUFDO0lBQ0gsNEJBQTRCO0lBQzVCLGdDQUFnQztJQUNoQyxPQUFPLE9BQU8sQ0FBQztBQUNuQixDQUFDO0FBRU0sS0FBSyxVQUFVLHlCQUF5QixDQUFDLEVBQVUsRUFBRSxLQUF3QixFQUFFLElBQVk7SUFDOUYsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFBLG9DQUFtQixFQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzdDLElBQUksQ0FBQyxNQUFN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QUFLLFVBQVUsY0FBYyxDQUFDLEVBQVUsRUFBRSxJQUF1QjtJQUNwRSxPQUFPLE1BQU0seUJBQXlCLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxJQUFJLFFBQVEsQ0FBQyxDQUFDO0FBQ2pGLENBQUM7QUFFTSxLQUFLLFVBQVUsY0FBYyxDQUFDLEVBQVU7SUFDM0MsT0FBTyxNQUFNLHVCQUF1QixDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQzdDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0RvY3VtZW50cy9xdWVzdC9EZXNrdG9wL3F1ZXN0L3NyYy9tYWluL2FwcC9kb21haW5zL3Rlc3RjYXNlcy9zZXJ2aWNlcy90ZXN0Q2FzZVNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlVGVzdENhc2UgYXMgY3JlYXRlVGVzdENhc2VSZXBvLCBnZXRUZXN0Q2FzZUJ5SWQgYXMgZ2V0VGVzdENhc2VCeUlkUmVwbywgdXBkYXRlVGVzdENhc2UgYXMgdXBkYXRlVGVzdENhc2VSZXBvLCBkZWxldGVUZXN0Q2FzZSBhcyBkZWxldGVUZXN0Q2FzZVJlcG8sIGxpc3RUZXN0Q2FzZXMsIGNyZWF0ZVRlc3RDYXNlVmVyc2lvbiwgbGlzdFRlc3RDYXNlVmVyc2lvbnMgfSBmcm9tICcuLi9yZXBvc2l0b3JpZXMvdGVzdENhc2VSZXBvc2l0b3J5JztcbmltcG9ydCB7IGluZGV4VGVzdENhc2UsIHJlbW92ZVRlc3RDYXNlRnJvbUluZGV4IH0gZnJvbSAnLi4vZWxhc3RpY3NlYXJjaC90ZXN0Q2FzZUluZGV4ZXInO1xuaW1wb3J0IHsgVGVzdENhc2UsIFRlc3RDYXNlVmVyc2lvbiB9IGZyb20gJy4uL3R5cGVzJztcblxuZnVuY3Rpb24gb21pdEZpZWxkczxUIGV4dGVuZHMgb2JqZWN0LCBLIGV4dGVuZHMga2V5b2YgVD4ob2JqOiBULCBrZXlzOiBLW10pOiBPbWl0PFQsIEs+IHtcbiAgICBjb25zdCBjb3B5ID0geyAuLi5vYmogfTtcbiAgICBrZXlzLmZvckVhY2goayA9PiB7IGRlbGV0ZSAoY29weSBhcyBhbnkpW2tdOyB9KTtcbiAgICByZXR1cm4gY29weSBhcyBPbWl0PFQsIEs+O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlVGVzdENhc2VXaXRoVmVyc2lvbih0YzogT21pdDxUZXN0Q2FzZSwgJ2lkJyB8ICdjcmVhdGVkQXQnIHwgJ3VwZGF0ZWRBdCc+KTogUHJvbWlzZTxUZXN0Q2FzZT4ge1xuICAgIGNvbnN0IGNyZWF0ZWQgPSBhd2FpdCBjcmVhdGVUZXN0Q2FzZVJlcG8odGMpO1xuICAgIGF3YWl0IGNyZWF0ZVRlc3RDYXNlVmVyc2lvbih7XG4gICAgICAgIHRlc3RjYXNlSWQ6IGNyZWF0ZWQuaWQsXG4gICAgICAgIHZlcnNpb246IDEsXG4gICAgICAgIGRhdGE6IHsgLi4udGMgfSxcbiAgICAgICAgY3JlYXRlZEJ5OiB0Yy5jcmVhdGVkQnksXG4gICAgfSk7XG4gICAgLy8gRWxhc3RpY3NlYXJjaCDsnbjrjbHsi7Eg7J6E7IucIOu5hO2ZnOyEse2ZlFxuICAgIC8vIGF3YWl0IGluZGV4VGVzdENhc2UoY3JlYXRlZCk7XG4gICAgcmV0dXJuIGNyZWF0ZWQ7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVUZXN0Q2FzZVdpdGhWZXJzaW9uKGlkOiBudW1iZXIsIHBhdGNoOiBQYXJ0aWFsPFRlc3RDYXNlPiwgdXNlcjogc3RyaW5nKTogUHJvbWlzZTxUZXN0Q2FzZSB8IG51bGw+IHtcbiAgICBjb25zdCBiZWZvcmUgPSBhd2FpdCBnZXRUZXN0Q2FzZUJ5SWRSZXBvKGlkKTtcbiAgICBpZiAoIWJlZm9yZSkgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgdXBkYXRlZCA9IGF3YWl0IHVwZGF0ZVRlc3RDYXNlUmVwbyhpZCwgcGF0Y2gpO1xuICAgIGlmICghdXBkYXRlZCkgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgdmVyc2lvbnMgPSBhd2FpdCBsaXN0VGVzdENhc2VWZXJzaW9ucyhpZCk7XG4gICAgYXdhaXQgY3JlYXRlVGVzdENhc2VWZXJzaW9uKHtcbiAgICAgICAgdGVzdGNhc2VJZDogaWQsXG4gICAgICAgIHZlcnNpb246ICh2ZXJzaW9uc1swXT8udmVyc2lvbiB8fCAxKSArIDEsXG4gICAgICAgIGRhdGE6IG9taXRGaWVsZHModXBkYXRlZCwgWydpZCcsICdjcmVhdGVkQXQnLCAndXBkYXRlZEF0J10pLFxuICAgICAgICBjcmVhdGVkQnk6IHVzZXIsXG4gICAgfSk7XG4gICAgLy8gRWxhc3RpY3NlYXJjaCDsnbjrjbHsi7Eg7J6E7IucIOu5hO2ZnOyEse2ZlFxuICAgIC8vIGF3YWl0IGluZGV4VGVzdENhc2UodXBkYXRlZCk7XG4gICAgcmV0dXJuIHVwZGF0ZWQ7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVUZXN0Q2FzZVdpdGhJbmRleChpZDogbnVtYmVyKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3Qgb2sgPSBhd2FpdCBkZWxldGVUZXN0Q2FzZVJlcG8oaWQpO1xuICAgIC8vIEVsYXN0aWNzZWFyY2gg7J24642x7IuxIOyehOyLnCDruYTtmZzshLHtmZRcbiAgICAvLyBpZiAob2spIGF3YWl0IHJlbW92ZVRlc3RDYXNlRnJvbUluZGV4KGlkKTtcbiAgICByZXR1cm4gb2s7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUZXN0Q2FzZVZlcnNpb25zKGlkOiBudW1iZXIpOiBQcm9taXNlPFRlc3RDYXNlVmVyc2lvbltdPiB7XG4gICAgcmV0dXJuIGxpc3RUZXN0Q2FzZVZlcnNpb25zKGlkKTtcbn1cblxuLy8g7Luo7Yq466Gk65+s7JeQ7IScIOyCrOyaqe2VoCDrqZTshJzrk5zrk6RcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUZXN0Q2FzZXMocGFyYW1zOiB7XG4gICAgcGFnZTogbnVtYmVyO1xuICAgIGxpbWl0OiBudW1iZXI7XG4gICAgc2VhcmNoPzogc3RyaW5nO1xuICAgIGZvbGRlcklkPzogbnVtYmVyO1xufSk6IFByb21pc2U8eyB0ZXN0Q2FzZXM6IFRlc3RDYXNlW107IHRvdGFsOiBudW1iZXIgfT4ge1xuICAgIGNvbnN0IHRlc3RDYXNlcyA9IGF3YWl0IGxpc3RUZXN0Q2FzZXMoKTtcbiAgICBcbiAgICAvLyDqsITri6jtlZwg7ZWE7YSw66eBICjsi6TsoJzroZzripQgcmVwb3NpdG9yeeyXkOyEnCDsspjrpqztlbTslbwg7ZWoKVxuICAgIGxldCBmaWx0ZXJlZENhc2VzID0gdGVzdENhc2VzO1xuICAgIFxuICAgIGlmIChwYXJhbXMuc2VhcmNoKSB7XG4gICAgICAgIGZpbHRlcmVkQ2FzZXMgPSBmaWx0ZXJlZENhc2VzLmZpbHRlcih0YyA9PiBcbiAgICAgICAgICAgIHRjLnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocGFyYW1zLnNlYXJjaCEudG9Mb3dlckNhc2UoKSkgfHxcbiAgICAgICAgICAgIHRjLnByZXJlcT8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhwYXJhbXMuc2VhcmNoIS50b0xvd2VyQ2FzZSgpKSB8fFxuICAgICAgICAgICAgdGMuZXhwZWN0ZWQ/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocGFyYW1zLnNlYXJjaCEudG9Mb3dlckNhc2UoKSlcbiAgICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKHBhcmFtcy5mb2xkZXJJZCkge1xuICAgICAgICBmaWx0ZXJlZENhc2VzID0gZmlsdGVyZWRDYXNlcy5maWx0ZXIodGMgPT4gdGMuZm9sZGVySWQgPT09IHBhcmFtcy5mb2xkZXJJZCk7XG4gICAgfVxuICAgIFxuICAgIC8vIO2OmOydtOynlSDsspjrpqxcbiAgICBjb25zdCBvZmZzZXQgPSAocGFyYW1zLnBhZ2UgLSAxKSAqIHBhcmFtcy5saW1pdDtcbiAgICBjb25zdCBwYWdpbmF0ZWRDYXNlcyA9IGZpbHRlcmVkQ2FzZXMuc2xpY2Uob2Zmc2V0LCBvZmZzZXQgKyBwYXJhbXMubGltaXQpO1xuICAgIFxuICAgIHJldHVybiB7IFxuICAgICAgICB0ZXN0Q2FzZXM6IHBhZ2luYXRlZENhc2VzLCBcbiAgICAgICAgdG90YWw6IGZpbHRlcmVkQ2FzZXMubGVuZ3RoIFxuICAgIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRUZXN0Q2FzZUJ5SWQoaWQ6IG51bWJlcik6IFByb21pc2U8VGVzdENhc2UgfCBudWxsPiB7XG4gICAgcmV0dXJuIGF3YWl0IGdldFRlc3RDYXNlQnlJZFJlcG8oaWQpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlVGVzdENhc2UoZGF0YTogT21pdDxUZXN0Q2FzZSwgJ2lkJyB8ICdjcmVhdGVkQXQnIHwgJ3VwZGF0ZWRBdCc+KTogUHJvbWlzZTxUZXN0Q2FzZT4ge1xuICAgIHJldHVybiBhd2FpdCBjcmVhdGVUZXN0Q2FzZVdpdGhWZXJzaW9uKGRhdGEpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGVzdENhc2UoaWQ6IG51bWJlciwgZGF0YTogUGFydGlhbDxUZXN0Q2FzZT4pOiBQcm9taXNlPFRlc3RDYXNlIHwgbnVsbD4ge1xuICAgIHJldHVybiBhd2FpdCB1cGRhdGVUZXN0Q2FzZVdpdGhWZXJzaW9uKGlkLCBkYXRhLCBkYXRhLmNyZWF0ZWRCeSB8fCAnc3lzdGVtJyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVUZXN0Q2FzZShpZDogbnVtYmVyKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIGF3YWl0IGRlbGV0ZVRlc3RDYXNlV2l0aEluZGV4KGlkKTtcbn0gIl0sInZlcnNpb24iOjN9