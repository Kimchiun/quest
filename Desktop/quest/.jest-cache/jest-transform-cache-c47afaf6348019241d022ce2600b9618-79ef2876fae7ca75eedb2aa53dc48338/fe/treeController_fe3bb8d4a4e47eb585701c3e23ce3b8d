fad672bd51be16847a871b0cad99ff90
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const treeService = __importStar(require("../services/treeService"));
/**
 * @swagger
 * components:
 *   schemas:
 *     TreeNode:
 *       type: object
 *       properties:
 *         id:
 *           type: integer
 *           description: 노드 ID
 *         name:
 *           type: string
 *           description: 노드 이름
 *         type:
 *           type: string
 *           enum: [folder, testcase, suite]
 *           description: 노드 타입
 *         parentId:
 *           type: integer
 *           nullable: true
 *           description: 부모 노드 ID
 *         sortOrder:
 *           type: integer
 *           description: 정렬 순서
 *         createdBy:
 *           type: string
 *           description: 생성자
 *         createdAt:
 *           type: string
 *           format: date-time
 *           description: 생성일
 *         updatedAt:
 *           type: string
 *           format: date-time
 *           description: 수정일
 *     TreeStructure:
 *       type: object
 *       properties:
 *         nodes:
 *           type: array
 *           items:
 *             $ref: '#/components/schemas/TreeNode'
 *         rootNodes:
 *           type: array
 *           items:
 *             $ref: '#/components/schemas/TreeNode'
 */
const router = (0, express_1.Router)();
// =====================================================
// 기본 CRUD 엔드포인트
// =====================================================
/**
 * @swagger
 * /api/tree/structure:
 *   get:
 *     summary: 트리 구조 조회
 *     description: 전체 트리 구조를 조회합니다.
 *     tags: [Tree]
 *     responses:
 *       200:
 *         description: 트리 구조 조회 성공
 *         content:
 *           application/json:
 *             schema:
 *               $ref: '#/components/schemas/TreeStructure'
 *       500:
 *         description: 서버 오류
 */
// 트리 구조 조회
router.get('/structure', async (req, res) => {
    try {
        const treeStructure = await treeService.getTreeStructure();
        res.json(treeStructure);
    }
    catch (error) {
        console.error('트리 구조 조회 실패:', error);
        res.status(500).json({
            message: error instanceof Error ? error.message : '트리 구조 조회에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
/**
 * @swagger
 * /api/tree:
 *   get:
 *     summary: 모든 트리 노드 조회
 *     description: 모든 트리 노드를 조회합니다.
 *     tags: [Tree]
 *     responses:
 *       200:
 *         description: 트리 노드 조회 성공
 *         content:
 *           application/json:
 *             schema:
 *               type: array
 *               items:
 *                 $ref: '#/components/schemas/TreeNode'
 *       500:
 *         description: 서버 오류
 */
// 모든 노드 조회
router.get('/', async (req, res) => {
    try {
        const nodes = await treeService.getAllTreeNodes();
        res.json(nodes);
    }
    catch (error) {
        console.error('노드 조회 실패:', error);
        res.status(500).json({
            message: error instanceof Error ? error.message : '노드 조회에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
// 특정 노드 조회
router.get('/:id', async (req, res) => {
    try {
        const id = parseInt(req.params.id);
        if (isNaN(id)) {
            return res.status(400).json({ message: '유효하지 않은 노드 ID입니다.' });
        }
        const node = await treeService.getTreeNodeById(id);
        if (!node) {
            return res.status(404).json({ message: '노드를 찾을 수 없습니다.' });
        }
        res.json(node);
    }
    catch (error) {
        console.error('노드 조회 실패:', error);
        res.status(500).json({
            message: error instanceof Error ? error.message : '노드 조회에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
// 노드 생성
router.post('/', async (req, res) => {
    try {
        console.log('노드 생성 요청:', req.body);
        const nodeData = {
            name: req.body.name,
            type: req.body.type,
            parentId: req.body.parentId || null,
            createdBy: req.body.createdBy || 'system'
        };
        console.log('노드 데이터:', nodeData);
        const node = await treeService.createTreeNode(nodeData);
        console.log('노드 생성 성공:', node);
        res.status(201).json(node);
    }
    catch (error) {
        console.error('노드 생성 실패:', error);
        res.status(400).json({
            message: error instanceof Error ? error.message : '노드 생성에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
// 노드 수정
router.put('/:id', async (req, res) => {
    try {
        const id = parseInt(req.params.id);
        if (isNaN(id)) {
            return res.status(400).json({ message: '유효하지 않은 노드 ID입니다.' });
        }
        const updateData = {
            name: req.body.name,
            parentId: req.body.parentId,
            sortOrder: req.body.sortOrder
        };
        const node = await treeService.updateTreeNode(id, updateData);
        if (!node) {
            return res.status(404).json({ message: '노드를 찾을 수 없습니다.' });
        }
        res.json(node);
    }
    catch (error) {
        console.error('노드 수정 실패:', error);
        res.status(400).json({
            message: error instanceof Error ? error.message : '노드 수정에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
// 노드 삭제
router.delete('/:id', async (req, res) => {
    try {
        const id = parseInt(req.params.id);
        if (isNaN(id)) {
            return res.status(400).json({ message: '유효하지 않은 노드 ID입니다.' });
        }
        const success = await treeService.deleteTreeNode(id);
        if (!success) {
            return res.status(404).json({ message: '노드를 찾을 수 없습니다.' });
        }
        res.json({ message: '노드가 성공적으로 삭제되었습니다.' });
    }
    catch (error) {
        console.error('노드 삭제 실패:', error);
        res.status(400).json({
            message: error instanceof Error ? error.message : '노드 삭제에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
// =====================================================
// 검색 엔드포인트
// =====================================================
// 노드 검색
router.get('/search', async (req, res) => {
    try {
        const searchRequest = {
            query: req.query.query,
            type: req.query.type,
            parentId: req.query.parentId ? parseInt(req.query.parentId) : undefined,
            limit: req.query.limit ? parseInt(req.query.limit) : undefined,
            offset: req.query.offset ? parseInt(req.query.offset) : undefined
        };
        const result = await treeService.searchTreeNodes(searchRequest);
        res.json(result);
    }
    catch (error) {
        console.error('노드 검색 실패:', error);
        res.status(500).json({
            message: error instanceof Error ? error.message : '노드 검색에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
// =====================================================
// 드래그 앤 드롭 엔드포인트
// =====================================================
// 드래그 앤 드롭 처리
router.post('/dragdrop', async (req, res) => {
    try {
        const { draggedNodeId, targetNodeId, dropType, position } = req.body;
        if (!draggedNodeId || !targetNodeId || !dropType) {
            return res.status(400).json({ message: '필수 파라미터가 누락되었습니다.' });
        }
        const dragDropRequest = {
            sourceId: draggedNodeId,
            targetId: targetNodeId,
            position
        };
        const result = await treeService.handleTreeNodeDragDrop(dragDropRequest);
        res.json(result);
    }
    catch (error) {
        console.error('드래그 앤 드롭 실패:', error);
        res.status(400).json({
            message: error instanceof Error ? error.message : '드래그 앤 드롭에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
// 드롭 영역 유효성 검사
router.post('/validate-drop', async (req, res) => {
    try {
        const { draggedNodeId, targetNodeId, dropZone } = req.body;
        if (!draggedNodeId || !targetNodeId || !dropZone) {
            return res.status(400).json({ message: '필수 파라미터가 누락되었습니다.' });
        }
        const validation = await treeService.validateDropZone(draggedNodeId, targetNodeId, dropZone);
        res.json(validation);
    }
    catch (error) {
        console.error('드롭 영역 유효성 검사 실패:', error);
        res.status(500).json({
            message: error instanceof Error ? error.message : '드롭 영역 유효성 검사에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
// =====================================================
// 성능 모니터링 엔드포인트
// =====================================================
// 성능 통계 조회
router.get('/performance/stats', async (req, res) => {
    try {
        // 성능 통계 로직 구현
        res.json({ message: '성능 통계 기능은 추후 구현 예정입니다.' });
    }
    catch (error) {
        console.error('성능 통계 조회 실패:', error);
        res.status(500).json({
            message: error instanceof Error ? error.message : '성능 통계 조회에 실패했습니다.',
            error: error instanceof Error ? error.stack : String(error)
        });
    }
});
exports.default = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0RvY3VtZW50cy9xdWVzdC9EZXNrdG9wL3F1ZXN0L3NyYy9tYWluL2FwcC9kb21haW5zL3RyZWUvY29udHJvbGxlcnMvdHJlZUNvbnRyb2xsZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxxQ0FBaUM7QUFDakMscUVBQXVEO0FBR3ZEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBOENHO0FBRUgsTUFBTSxNQUFNLEdBQUcsSUFBQSxnQkFBTSxHQUFFLENBQUM7QUFFeEIsd0RBQXdEO0FBQ3hELGdCQUFnQjtBQUNoQix3REFBd0Q7QUFFeEQ7Ozs7Ozs7Ozs7Ozs7Ozs7R0FnQkc7QUFDSCxXQUFXO0FBQ1gsTUFBTSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtJQUMxQyxJQUFJLENBQUM7UUFDSCxNQUFNLGFBQWEsR0FBRyxNQUFNLFdBQVcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQzNELEdBQUcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDZixPQUFPLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNyQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUNuQixPQUFPLEVBQUUsS0FBSyxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsbUJBQW1CO1lBQ3JFLEtBQUssRUFBRSxLQUFLLFlBQVksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1NBQzVELENBQUMsQ0FBQztJQUNMLENBQUM7QUFDSCxDQUFDLENBQUMs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NUQsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDO0FBRUgsd0RBQXdEO0FBQ3hELGdCQUFnQjtBQUNoQix3REFBd0Q7QUFFeEQsV0FBVztBQUNYLE1BQU0sQ0FBQyxHQUFHLENBQUMsb0JBQW9CLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtJQUNsRCxJQUFJLENBQUM7UUFDSCxjQUFjO1FBQ2QsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDZixPQUFPLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNyQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUNuQixPQUFPLEVBQUUsS0FBSyxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsbUJBQW1CO1lBQ3JFLEtBQUssRUFBRSxLQUFLLFlBQVksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1NBQzVELENBQUMsQ0FBQztJQUNMLENBQUM7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVILGtCQUFlLE1BQU0sQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvM2ktYTEtMjAyMS0wMTcvRG9jdW1lbnRzL3F1ZXN0L0Rlc2t0b3AvcXVlc3Qvc3JjL21haW4vYXBwL2RvbWFpbnMvdHJlZS9jb250cm9sbGVycy90cmVlQ29udHJvbGxlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCAqIGFzIHRyZWVTZXJ2aWNlIGZyb20gJy4uL3NlcnZpY2VzL3RyZWVTZXJ2aWNlJztcbmltcG9ydCB7IENyZWF0ZVRyZWVOb2RlUmVxdWVzdCwgVXBkYXRlVHJlZU5vZGVSZXF1ZXN0LCBEcmFnRHJvcFJlcXVlc3QgfSBmcm9tICcuLi90eXBlcyc7XG5cbi8qKlxuICogQHN3YWdnZXJcbiAqIGNvbXBvbmVudHM6XG4gKiAgIHNjaGVtYXM6XG4gKiAgICAgVHJlZU5vZGU6XG4gKiAgICAgICB0eXBlOiBvYmplY3RcbiAqICAgICAgIHByb3BlcnRpZXM6XG4gKiAgICAgICAgIGlkOlxuICogICAgICAgICAgIHR5cGU6IGludGVnZXJcbiAqICAgICAgICAgICBkZXNjcmlwdGlvbjog64W465OcIElEXG4gKiAgICAgICAgIG5hbWU6XG4gKiAgICAgICAgICAgdHlwZTogc3RyaW5nXG4gKiAgICAgICAgICAgZGVzY3JpcHRpb246IOuFuOuTnCDsnbTrpoRcbiAqICAgICAgICAgdHlwZTpcbiAqICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICAgICAgICBlbnVtOiBbZm9sZGVyLCB0ZXN0Y2FzZSwgc3VpdGVdXG4gKiAgICAgICAgICAgZGVzY3JpcHRpb246IOuFuOuTnCDtg4DsnoVcbiAqICAgICAgICAgcGFyZW50SWQ6XG4gKiAgICAgICAgICAgdHlwZTogaW50ZWdlclxuICogICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gKiAgICAgICAgICAgZGVzY3JpcHRpb246IOu2gOuqqCDrhbjrk5wgSURcbiAqICAgICAgICAgc29ydE9yZGVyOlxuICogICAgICAgICAgIHR5cGU6IGludGVnZXJcbiAqICAgICAgICAgICBkZXNjcmlwdGlvbjog7KCV66CsIOyInOyEnFxuICogICAgICAgICBjcmVhdGVkQnk6XG4gKiAgICAgICAgICAgdHlwZTogc3RyaW5nXG4gKiAgICAgICAgICAgZGVzY3JpcHRpb246IOyDneyEseyekFxuICogICAgICAgICBjcmVhdGVkQXQ6XG4gKiAgICAgICAgICAgdHlwZTogc3RyaW5nXG4gKiAgICAgICAgICAgZm9ybWF0OiBkYXRlLXRpbWVcbiAqICAgICAgICAgICBkZXNjcmlwdGlvbjog7IOd7ISx7J28XG4gKiAgICAgICAgIHVwZGF0ZWRBdDpcbiAqICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICAgICAgICBmb3JtYXQ6IGRhdGUtdGltZVxuICogICAgICAgICAgIGRlc2NyaXB0aW9uOiDsiJjsoJXsnbxcbiAqICAgICBUcmVlU3RydWN0dXJlOlxuICogICAgICAgdHlwZTogb2JqZWN0XG4gKiAgICAgICBwcm9wZXJ0aWVzOlxuICogICAgICAgICBub2RlczpcbiAqICAgICAgICAgICB0eXBlOiBhcnJheVxuICogICAgICAgICAgIGl0ZW1zOlxuICogICAgICAgICAgICAgJHJlZjogJyMvY29tcG9uZW50cy9zY2hlbWFzL1RyZWVOb2RlJ1xuICogICAgICAgICByb290Tm9kZXM6XG4gKiAgICAgICAgICAgdHlwZTogYXJyYXlcbiAqICAgICAgICAgICBpdGVtczpcbiAqICAgICAgICAgICAgICRyZWY6ICcjL2NvbXBvbmVudHMvc2NoZW1hcy9UcmVlTm9kZSdcbiAqL1xuXG5jb25zdCByb3V0ZXIgPSBSb3V0ZXIoKTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOq4sOuzuCBDUlVEIOyXlOuTnO2PrOyduO2KuFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBAc3dhZ2dlclxuICogL2FwaS90cmVlL3N0cnVjdHVyZTpcbiAqICAgZ2V0OlxuICogICAgIHN1bW1hcnk6IO2KuOumrCDqtazsobAg7KGw7ZqMXG4gKiAgICAgZGVzY3JpcHRpb246IOyghOyytCDtirjrpqwg6rWs7KGw66W8IOyhsO2ajO2VqeuLiOuLpC5cbiAqICAgICB0YWdzOiBbVHJlZV1cbiAqICAgICByZXNwb25zZXM6XG4gKiAgICAgICAyMDA6XG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiDtirjrpqwg6rWs7KGwIOyhsO2ajCDshLHqs7VcbiAqICAgICAgICAgY29udGVudDpcbiAqICAgICAgICAgICBhcHBsaWNhdGlvbi9qc29uOlxuICogICAgICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgICAgICAkcmVmOiAnIy9jb21wb25lbnRzL3NjaGVtYXMvVHJlZVN0cnVjdHVyZSdcbiAqICAgICAgIDUwMDpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IOyEnOuyhCDsmKTrpZhcbiAqL1xuLy8g7Yq466asIOq1rOyhsCDsobDtmoxcbnJvdXRlci5nZXQoJy9zdHJ1Y3R1cmUnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB0cmVlU3RydWN0dXJlID0gYXdhaXQgdHJlZVNlcnZpY2UuZ2V0VHJlZVN0cnVjdHVyZSgpO1xuICAgIHJlcy5qc29uKHRyZWVTdHJ1Y3R1cmUpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+2KuOumrCDqtazsobAg7KGw7ZqMIOyLpO2MqDonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ+2KuOumrCDqtazsobAg7KGw7ZqM7JeQIOyLpO2MqO2WiOyKteuLiOuLpC4nLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6IFN0cmluZyhlcnJvcilcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8qKlxuICogQHN3YWdnZXJcbiAqIC9hcGkvdHJlZTpcbiAqICAgZ2V0OlxuICogICAgIHN1bW1hcnk6IOuqqOuToCDtirjrpqwg64W465OcIOyhsO2ajFxuICogICAgIGRlc2NyaXB0aW9uOiDrqqjrk6Ag7Yq466asIOuFuOuTnOulvCDsobDtmoztlanri4jri6QuXG4gKiAgICAgdGFnczogW1RyZWVdXG4gKiAgICAgcmVzcG9uc2VzOlxuICogICAgICAgMjAwOlxuICogICAgICAgICBkZXNjcmlwdGlvbjog7Yq466asIOuFuOuTnCDsobDtmowg7ISx6rO1XG4gKiAgICAgICAgIGNvbnRlbnQ6XG4gKiAgICAgICAgICAgYXBwbGljYXRpb24vanNvbjpcbiAqICAgICAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICAgICAgdHlwZTogYXJyYXlcbiAqICAgICAgICAgICAgICAgaXRlbXM6XG4gKiAgICAgICAgICAgICAgICAgJHJlZjogJyMvY29tcG9uZW50cy9zY2hlbWFzL1RyZWVOb2RlJ1xuICogICAgICAgNTAwOlxuICogICAgICAgICBkZXNjcmlwdGlvbjog7ISc67KEIOyYpOulmFxuICovXG4vLyDrqqjrk6Ag64W465OcIOyhsO2ajFxucm91dGVyLmdldCgnLycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgdHJlZVNlcnZpY2UuZ2V0QWxsVHJlZU5vZGVzKCk7XG4gICAgcmVzLmpzb24obm9kZXMpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+uFuOuTnCDsobDtmowg7Iuk7YyoOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn64W465OcIOyhsO2ajOyXkCDsi6TtjKjtlojsirXri4jri6QuJyxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiBTdHJpbmcoZXJyb3IpXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyDtirnsoJUg64W465OcIOyhsO2ajFxucm91dGVyLmdldCgnLzppZCcsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGlkID0gcGFyc2VJbnQocmVxLnBhcmFtcy5pZCk7XG4gICAgaWYgKGlzTmFOKGlkKSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ+ycoO2aqO2VmOyngCDslYrsnYAg64W465OcIElE7J6F64uI64ukLicgfSk7XG4gICAgfVxuXG4gICAgY29uc3Qgbm9kZSA9IGF3YWl0IHRyZWVTZXJ2aWNlLmdldFRyZWVOb2RlQnlJZChpZCk7XG4gICAgaWYgKCFub2RlKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiAn64W465Oc66W8IOywvuydhCDsiJgg7JeG7Iq164uI64ukLicgfSk7XG4gICAgfVxuXG4gICAgcmVzLmpzb24obm9kZSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign64W465OcIOyhsO2ajCDsi6TtjKg6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfrhbjrk5wg7KGw7ZqM7JeQIOyLpO2MqO2WiOyKteuLiOuLpC4nLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6IFN0cmluZyhlcnJvcilcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIOuFuOuTnCDsg53shLFcbnJvdXRlci5wb3N0KCcvJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ+uFuOuTnCDsg53shLEg7JqU7LKtOicsIHJlcS5ib2R5KTtcblxuICAgIGNvbnN0IG5vZGVEYXRhOiBDcmVhdGVUcmVlTm9kZVJlcXVlc3QgPSB7XG4gICAgICBuYW1lOiByZXEuYm9keS5uYW1lLFxuICAgICAgdHlwZTogcmVxLmJvZHkudHlwZSxcbiAgICAgIHBhcmVudElkOiByZXEuYm9keS5wYXJlbnRJZCB8fCBudWxsLFxuICAgICAgY3JlYXRlZEJ5OiByZXEuYm9keS5jcmVhdGVkQnkgfHwgJ3N5c3RlbSdcbiAgICB9O1xuXG4gICAgY29uc29sZS5sb2coJ+uFuOuTnCDrjbDsnbTthLA6Jywgbm9kZURhdGEpO1xuXG4gICAgY29uc3Qgbm9kZSA9IGF3YWl0IHRyZWVTZXJ2aWNlLmNyZWF0ZVRyZWVOb2RlKG5vZGVEYXRhKTtcbiAgICBjb25zb2xlLmxvZygn64W465OcIOyDneyEsSDshLHqs7U6Jywgbm9kZSk7XG4gICAgcmVzLnN0YXR1cygyMDEpLmpzb24obm9kZSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign64W465OcIOyDneyEsSDsi6TtjKg6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfrhbjrk5wg7IOd7ISx7JeQIOyLpO2MqO2WiOyKteuLiOuLpC4nLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6IFN0cmluZyhlcnJvcilcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIOuFuOuTnCDsiJjsoJVcbnJvdXRlci5wdXQoJy86aWQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBpZCA9IHBhcnNlSW50KHJlcS5wYXJhbXMuaWQpO1xuICAgIGlmIChpc05hTihpZCkpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICfsnKDtmqjtlZjsp4Ag7JWK7J2AIOuFuOuTnCBJROyeheuLiOuLpC4nIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHVwZGF0ZURhdGE6IFVwZGF0ZVRyZWVOb2RlUmVxdWVzdCA9IHtcbiAgICAgIG5hbWU6IHJlcS5ib2R5Lm5hbWUsXG4gICAgICBwYXJlbnRJZDogcmVxLmJvZHkucGFyZW50SWQsXG4gICAgICBzb3J0T3JkZXI6IHJlcS5ib2R5LnNvcnRPcmRlclxuICAgIH07XG5cbiAgICBjb25zdCBub2RlID0gYXdhaXQgdHJlZVNlcnZpY2UudXBkYXRlVHJlZU5vZGUoaWQsIHVwZGF0ZURhdGEpO1xuICAgIGlmICghbm9kZSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgbWVzc2FnZTogJ+uFuOuTnOulvCDssL7snYQg7IiYIOyXhuyKteuLiOuLpC4nIH0pO1xuICAgIH1cblxuICAgIHJlcy5qc29uKG5vZGUpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+uFuOuTnCDsiJjsoJUg7Iuk7YyoOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxuICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn64W465OcIOyImOygleyXkCDsi6TtjKjtlojsirXri4jri6QuJyxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiBTdHJpbmcoZXJyb3IpXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyDrhbjrk5wg7IKt7KCcXG5yb3V0ZXIuZGVsZXRlKCcvOmlkJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgaWQgPSBwYXJzZUludChyZXEucGFyYW1zLmlkKTtcbiAgICBpZiAoaXNOYU4oaWQpKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAn7Jyg7Zqo7ZWY7KeAIOyViuydgCDrhbjrk5wgSUTsnoXri4jri6QuJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgdHJlZVNlcnZpY2UuZGVsZXRlVHJlZU5vZGUoaWQpO1xuICAgIGlmICghc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgbWVzc2FnZTogJ+uFuOuTnOulvCDssL7snYQg7IiYIOyXhuyKteuLiOuLpC4nIH0pO1xuICAgIH1cblxuICAgIHJlcy5qc29uKHsgbWVzc2FnZTogJ+uFuOuTnOqwgCDshLHqs7XsoIHsnLzroZwg7IKt7KCc65CY7JeI7Iq164uI64ukLicgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign64W465OcIOyCreygnCDsi6TtjKg6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfrhbjrk5wg7IKt7KCc7JeQIOyLpO2MqO2WiOyKteuLiOuLpC4nLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5zdGFjayA6IFN0cmluZyhlcnJvcilcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDqsoDsg4kg7JeU65Oc7Y+s7J247Yq4XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLyDrhbjrk5wg6rKA7IOJXG5yb3V0ZXIuZ2V0KCcvc2VhcmNoJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2VhcmNoUmVxdWVzdCA9IHtcbiAgICAgIHF1ZXJ5OiByZXEucXVlcnkucXVlcnkgYXMgc3RyaW5nLFxuICAgICAgdHlwZTogcmVxLnF1ZXJ5LnR5cGUgYXMgJ2ZvbGRlcicgfCAndGVzdGNhc2UnLFxuICAgICAgcGFyZW50SWQ6IHJlcS5xdWVyeS5wYXJlbnRJZCA/IHBhcnNlSW50KHJlcS5xdWVyeS5wYXJlbnRJZCBhcyBzdHJpbmcpIDogdW5kZWZpbmVkLFxuICAgICAgbGltaXQ6IHJlcS5xdWVyeS5saW1pdCA/IHBhcnNlSW50KHJlcS5xdWVyeS5saW1pdCBhcyBzdHJpbmcpIDogdW5kZWZpbmVkLFxuICAgICAgb2Zmc2V0OiByZXEucXVlcnkub2Zmc2V0ID8gcGFyc2VJbnQocmVxLnF1ZXJ5Lm9mZnNldCBhcyBzdHJpbmcpIDogdW5kZWZpbmVkXG4gICAgfTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRyZWVTZXJ2aWNlLnNlYXJjaFRyZWVOb2RlcyhzZWFyY2hSZXF1ZXN0KTtcbiAgICByZXMuanNvbihyZXN1bHQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+uFuOuTnCDqsoDsg4kg7Iuk7YyoOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAn64W465OcIOqygOyDieyXkCDsi6TtjKjtlojsirXri4jri6QuJyxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiBTdHJpbmcoZXJyb3IpXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g65Oc656Y6re4IOyVpCDrk5zroa0g7JeU65Oc7Y+s7J247Yq4XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLyDrk5zrnpjqt7gg7JWkIOuTnOuhrSDsspjrpqxcbnJvdXRlci5wb3N0KCcvZHJhZ2Ryb3AnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRyYWdnZWROb2RlSWQsIHRhcmdldE5vZGVJZCwgZHJvcFR5cGUsIHBvc2l0aW9uIH0gPSByZXEuYm9keTtcblxuICAgIGlmICghZHJhZ2dlZE5vZGVJZCB8fCAhdGFyZ2V0Tm9kZUlkIHx8ICFkcm9wVHlwZSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ+2VhOyImCDtjIzrnbzrr7jthLDqsIAg64iE652965CY7JeI7Iq164uI64ukLicgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgZHJhZ0Ryb3BSZXF1ZXN0OiBEcmFnRHJvcFJlcXVlc3QgPSB7XG4gICAgICBzb3VyY2VJZDogZHJhZ2dlZE5vZGVJZCxcbiAgICAgIHRhcmdldElkOiB0YXJnZXROb2RlSWQsXG4gICAgICBwb3NpdGlvblxuICAgIH07XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0cmVlU2VydmljZS5oYW5kbGVUcmVlTm9kZURyYWdEcm9wKGRyYWdEcm9wUmVxdWVzdCk7XG4gICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfrk5zrnpjqt7gg7JWkIOuTnOuhrSDsi6TtjKg6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfrk5zrnpjqt7gg7JWkIOuTnOuhreyXkCDsi6TtjKjtlojsirXri4jri6QuJyxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiBTdHJpbmcoZXJyb3IpXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyDrk5zroa0g7JiB7JetIOycoO2aqOyEsSDqsoDsgqxcbnJvdXRlci5wb3N0KCcvdmFsaWRhdGUtZHJvcCcsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZHJhZ2dlZE5vZGVJZCwgdGFyZ2V0Tm9kZUlkLCBkcm9wWm9uZSB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIWRyYWdnZWROb2RlSWQgfHwgIXRhcmdldE5vZGVJZCB8fCAhZHJvcFpvbmUpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICftlYTsiJgg7YyM652866+47YSw6rCAIOuIhOudveuQmOyXiOyKteuLiOuLpC4nIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBhd2FpdCB0cmVlU2VydmljZS52YWxpZGF0ZURyb3Bab25lKGRyYWdnZWROb2RlSWQsIHRhcmdldE5vZGVJZCwgZHJvcFpvbmUpO1xuICAgIHJlcy5qc29uKHZhbGlkYXRpb24pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+uTnOuhrSDsmIHsl60g7Jyg7Zqo7ISxIOqygOyCrCDsi6TtjKg6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfrk5zroa0g7JiB7JetIOycoO2aqOyEsSDqsoDsgqzsl5Ag7Iuk7Yyo7ZaI7Iq164uI64ukLicsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogU3RyaW5nKGVycm9yKVxuICAgIH0pO1xuICB9XG59KTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOyEseuKpSDrqqjri4jthLDrp4Eg7JeU65Oc7Y+s7J247Yq4XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vLyDshLHriqUg7Ya16rOEIOyhsO2ajFxucm91dGVyLmdldCgnL3BlcmZvcm1hbmNlL3N0YXRzJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIHRyeSB7XG4gICAgLy8g7ISx64qlIO2GteqzhCDroZzsp4Eg6rWs7ZiEXG4gICAgcmVzLmpzb24oeyBtZXNzYWdlOiAn7ISx64qlIO2GteqzhCDquLDriqXsnYAg7LaU7ZuEIOq1rO2YhCDsmIjsoJXsnoXri4jri6QuJyB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfshLHriqUg7Ya16rOEIOyhsO2ajCDsi6TtjKg6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICfshLHriqUg7Ya16rOEIOyhsO2ajOyXkCDsi6TtjKjtlojsirXri4jri6QuJyxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiBTdHJpbmcoZXJyb3IpXG4gICAgfSk7XG4gIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7ICJdLCJ2ZXJzaW9uIjozfQ==