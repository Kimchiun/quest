55832b25347113e9480866954866f419
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("@testing-library/react");
require("@testing-library/jest-dom");
const EditableCell_1 = __importDefault(require("../src/renderer/shared/components/EditableCell"));
describe('EditableCell', () => {
    const mockOnSave = jest.fn();
    const mockOnCancel = jest.fn();
    beforeEach(() => {
        jest.clearAllMocks();
    });
    describe('텍스트 타입', () => {
        it('기본값을 표시한다', () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "\uD14C\uC2A4\uD2B8 \uC81C\uBAA9", type: "text", onSave: mockOnSave }));
            expect(react_1.screen.getByText('테스트 제목')).toBeInTheDocument();
        });
        it('클릭 시 편집 모드로 진입한다', () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "\uD14C\uC2A4\uD2B8 \uC81C\uBAA9", type: "text", onSave: mockOnSave }));
            const displayElement = react_1.screen.getByText('테스트 제목');
            react_1.fireEvent.click(displayElement);
            expect(react_1.screen.getByDisplayValue('테스트 제목')).toBeInTheDocument();
        });
        it('Enter 키로 저장한다', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "\uD14C\uC2A4\uD2B8 \uC81C\uBAA9", type: "text", onSave: mockOnSave }));
            const displayElement = react_1.screen.getByText('테스트 제목');
            react_1.fireEvent.click(displayElement);
            const input = react_1.screen.getByDisplayValue('테스트 제목');
            react_1.fireEvent.change(input, { target: { value: '새 제목' } });
            react_1.fireEvent.keyDown(input, { key: 'Enter' });
            await (0, react_1.waitFor)(() => {
                expect(mockOnSave).toHaveBeenCalledWith('새 제목');
            });
        });
        it('Escape 키로 취소한다', () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "\uD14C\uC2A4\uD2B8 \uC81C\uBAA9", type: "text", onSave: mockOnSave, onCancel: mockOnCancel }));
            const displayElement = react_1.screen.getByText('테스트 제목');
            react_1.fireEvent.click(displayElement);
            const input = react_1.screen.getByDisplayValue('테스트 제목');
            react_1.fireEvent.change(input, { target: { value: '새 제목' } });
            react_1.fireEvent.keyDown(input, { key: 'Escape' });
            expect(mockOnCancel).toHaveBeenCalled();
            expect(react_1.screen.getByText('테스트 제목')).toBeInTheDocument();
        });
        it('자동저장을 500ms debounce로 실행한다', async () => {
            jest.useFakeTimers();
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "\uD14C\uC2A4\uD2B8 \uC81C\uBAA9", type: "text", onSave: mockOnSave }));
            const displayElement = react_1.screen.getByText('테스트 제목');
            react_1.fireEvent.click(displayElement);
            const input = react_1.screen.getByDisplayValue('테스트 제목');
            react_1.fireEvent.change(input, { target: { value: '새 제목' } });
            // 500ms 이전에는 호출되지 않음
            expect(mockOnSave).not.toHaveBeenCalled();
            // 500ms 후 호출됨
            jest.advanceTimersByTime(500);
            await (0, react_1.waitFor)(() => {
                expect(mockOnSave).toHaveBeenCalledWith('새 제목');
            });
            jest.useRealTimers();
        });
    });
    describe('셀렉트 타입', () => {
        const options = [
            { value: 'Active', label: '활성' },
            { value: 'Inactive', label: '비활성' },
            { value: 'Draft', label: '초안' }
        ];
        it('옵션을 표시한다', () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "Active", type: "select", options: options, onSave: mockOnSave }));
            expect(react_1.screen.getByText('활성')).toBeInTheDocument();
        });
        it('클릭 시 셀렉트로 변경된다', () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "Active", type: "select", options: options, onSave: mockOnSave }));
            const displayElement = react_1.screen.getByText('활성');
            react_1.fireEvent.click(displayElement);
            expect(react_1.screen.getByRole('combobox')).toBeInTheDocument();
        });
        it('값 변경 시 저장된다', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "Active", type: "select", options: options, onSave: mockOnSave }));
            const displayElement = react_1.screen.getByText('활성');
            react_1.fireEvent.click(displayElement);
            const select = react_1.screen.getByRole('combobox');
            react_1.fireEvent.change(select, { target: { value: 'Inactive' } });
            await (0, react_1.waitFor)(() => {
                expect(mockOnSave).toHaveBeenCalledWith('Inactive');
            });
        });
    });
    describe('체크박스 타입', () => {
        it('체크박스를 표시한다', () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: true, type: "checkbox", onSave: mockOnSave }));
            const checkbox = react_1.screen.getByRole('checkbox');
            expect(checkbox).toBeChecked();
        });
        it('체크박스 변경 시 저장된다', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: true, type: "checkbox", onSave: mockOnSave }));
            const checkbox = react_1.screen.getByRole('checkbox');
            react_1.fireEvent.click(checkbox);
            await (0, react_1.waitFor)(() => {
                expect(mockOnSave).toHaveBeenCalledWith(false);
            });
        });
    });
    describe('비활성화 상태', () => {
        it('disabled 시 클릭해도 편집되지 않는다', () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "\uD14C\uC2A4\uD2B8 \uC81C\uBAA9", type: "text", onSave: mockOnSave, disabled: true }));
            const displayElement = react_1.screen.getByText('테스트 제목');
            react_1.fireEvent.click(displayElement);
            expect(react_1.screen.queryByDisplayValue('테스트 제목')).not.toBeInTheDocument();
            expect(react_1.screen.getByText('테스트 제목')).toBeInTheDocument();
        });
    });
    describe('저장 표시', () => {
        it('저장 중 표시를 보여준다', async () => {
            (0, react_1.render)((0, jsx_runtime_1.jsx)(EditableCell_1.default, { value: "\uD14C\uC2A4\uD2B8 \uC81C\uBAA9", type: "text", onSave: mockOnSave }));
            const displayElement = react_1.screen.getByText('테스트 제목');
            react_1.fireEvent.click(displayElement);
            const input = react_1.screen.getByDisplayValue('테스트 제목');
            react_1.fireEvent.change(input, { target: { value: '새 제목' } });
            react_1.fireEvent.keyDown(input, { key: 'Enter' });
            await (0, react_1.waitFor)(() => {
                expect(react_1.screen.getByText('저장됨')).toBeInTheDocument();
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0RvY3VtZW50cy9xdWVzdC9EZXNrdG9wL3F1ZXN0L3Rlc3RzL2VkaXRhYmxlLWNlbGwudGVzdC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0Esa0RBQTRFO0FBQzVFLHFDQUFtQztBQUNuQyxrR0FBMEU7QUFFMUUsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7SUFDNUIsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0lBQzdCLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztJQUUvQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUU7UUFDdEIsRUFBRSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7WUFDbkIsSUFBQSxjQUFNLEVBQ0osdUJBQUMsc0JBQVksSUFDWCxLQUFLLEVBQUMsaUNBQVEsRUFDZCxJQUFJLEVBQUMsTUFBTSxFQUNYLE1BQU0sRUFBRSxVQUFVLEdBQ2xCLENBQ0gsQ0FBQztZQUVGLE1BQU0sQ0FBQyxjQUFNLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUN6RCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7WUFDMUIsSUFBQSxjQUFNLEVBQ0osdUJBQUMsc0JBQVksSUFDWCxLQUFLLEVBQUMsaUNBQVEsRUFDZCxJQUFJLEVBQUMsTUFBTSxFQUNYLE1BQU0sRUFBRSxVQUFVLEdBQ2xCLENBQ0gsQ0FBQztZQUVGLE1BQU0sY0FBYyxHQUFHLGNBQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDbEQsaUJBQVMsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUM7WUFFaEMsTUFBTSxDQUFDLGNBQU0sQ0FBQyxpQkFB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bnRzL3F1ZXN0L0Rlc2t0b3AvcXVlc3QvdGVzdHMvZWRpdGFibGUtY2VsbC50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgcmVuZGVyLCBzY3JlZW4sIGZpcmVFdmVudCwgd2FpdEZvciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0ICdAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tJztcbmltcG9ydCBFZGl0YWJsZUNlbGwgZnJvbSAnLi4vc3JjL3JlbmRlcmVyL3NoYXJlZC9jb21wb25lbnRzL0VkaXRhYmxlQ2VsbCc7XG5cbmRlc2NyaWJlKCdFZGl0YWJsZUNlbGwnLCAoKSA9PiB7XG4gIGNvbnN0IG1vY2tPblNhdmUgPSBqZXN0LmZuKCk7XG4gIGNvbnN0IG1vY2tPbkNhbmNlbCA9IGplc3QuZm4oKTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ+2FjeyKpO2KuCDtg4DsnoUnLCAoKSA9PiB7XG4gICAgaXQoJ+q4sOuzuOqwkuydhCDtkZzsi5ztlZzri6QnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxFZGl0YWJsZUNlbGxcbiAgICAgICAgICB2YWx1ZT1cIu2FjOyKpO2KuCDsoJzrqqlcIlxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgn7YWM7Iqk7Yq4IOygnOuqqScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+2BtOumrSDsi5wg7Y647KeRIOuqqOuTnOuhnCDsp4TsnoXtlZzri6QnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxFZGl0YWJsZUNlbGxcbiAgICAgICAgICB2YWx1ZT1cIu2FjOyKpO2KuCDsoJzrqqlcIlxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBkaXNwbGF5RWxlbWVudCA9IHNjcmVlbi5nZXRCeVRleHQoJ+2FjOyKpO2KuCDsoJzrqqknKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhkaXNwbGF5RWxlbWVudCk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlEaXNwbGF5VmFsdWUoJ+2FjOyKpO2KuCDsoJzrqqknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdFbnRlciDtgqTroZwg7KCA7J6l7ZWc64ukJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8RWRpdGFibGVDZWxsXG4gICAgICAgICAgdmFsdWU9XCLthYzsiqTtirgg7KCc66qpXCJcbiAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgb25TYXZlPXttb2NrT25TYXZlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZGlzcGxheUVsZW1lbnQgPSBzY3JlZW4uZ2V0QnlUZXh0KCfthYzsiqTtirgg7KCc66qpJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soZGlzcGxheUVsZW1lbnQpO1xuXG4gICAgICBjb25zdCBpbnB1dCA9IHNjcmVlbi5nZXRCeURpc3BsYXlWYWx1ZSgn7YWM7Iqk7Yq4IOygnOuqqScpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShpbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICfsg4gg7KCc66qpJyB9IH0pO1xuICAgICAgZmlyZUV2ZW50LmtleURvd24oaW5wdXQsIHsga2V5OiAnRW50ZXInIH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1vY2tPblNhdmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCfsg4gg7KCc66qpJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdFc2NhcGUg7YKk66GcIOy3qOyGjO2VnOuLpCcsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEVkaXRhYmxlQ2VsbFxuICAgICAgICAgIHZhbHVlPVwi7YWM7Iqk7Yq4IOygnOuqqVwiXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNhbmNlbD17bW9ja09uQ2FuY2VsfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZGlzcGxheUVsZW1lbnQgPSBzY3JlZW4uZ2V0QnlUZXh0KCfthYzsiqTtirgg7KCc66qpJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soZGlzcGxheUVsZW1lbnQpO1xuXG4gICAgICBjb25zdCBpbnB1dCA9IHNjcmVlbi5nZXRCeURpc3BsYXlWYWx1ZSgn7YWM7Iqk7Yq4IOygnOuqqScpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShpbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICfsg4gg7KCc66qpJyB9IH0pO1xuICAgICAgZmlyZUV2ZW50LmtleURvd24oaW5wdXQsIHsga2V5OiAnRXNjYXBlJyB9KTtcblxuICAgICAgZXhwZWN0KG1vY2tPbkNhbmNlbCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ+2FjOyKpO2KuCDsoJzrqqknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCfsnpDrj5nsoIDsnqXsnYQgNTAwbXMgZGVib3VuY2XroZwg7Iuk7ZaJ7ZWc64ukJywgYXN5bmMgKCkgPT4ge1xuICAgICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEVkaXRhYmxlQ2VsbFxuICAgICAgICAgIHZhbHVlPVwi7YWM7Iqk7Yq4IOygnOuqqVwiXG4gICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGRpc3BsYXlFbGVtZW50ID0gc2NyZWVuLmdldEJ5VGV4dCgn7YWM7Iqk7Yq4IOygnOuqqScpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGRpc3BsYXlFbGVtZW50KTtcblxuICAgICAgY29uc3QgaW5wdXQgPSBzY3JlZW4uZ2V0QnlEaXNwbGF5VmFsdWUoJ+2FjOyKpO2KuCDsoJzrqqknKTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UoaW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAn7IOIIOygnOuqqScgfSB9KTtcblxuICAgICAgLy8gNTAwbXMg7J207KCE7JeQ64qUIO2YuOy2nOuQmOyngCDslYrsnYxcbiAgICAgIGV4cGVjdChtb2NrT25TYXZlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuXG4gICAgICAvLyA1MDBtcyDtm4Qg7Zi47Lac65CoXG4gICAgICBqZXN0LmFkdmFuY2VUaW1lcnNCeVRpbWUoNTAwKTtcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja09uU2F2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ+yDiCDsoJzrqqknKTtcbiAgICAgIH0pO1xuXG4gICAgICBqZXN0LnVzZVJlYWxUaW1lcnMoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ+yFgOugie2KuCDtg4DsnoUnLCAoKSA9PiB7XG4gICAgY29uc3Qgb3B0aW9ucyA9IFtcbiAgICAgIHsgdmFsdWU6ICdBY3RpdmUnLCBsYWJlbDogJ+2ZnOyEsScgfSxcbiAgICAgIHsgdmFsdWU6ICdJbmFjdGl2ZScsIGxhYmVsOiAn67mE7Zmc7ISxJyB9LFxuICAgICAgeyB2YWx1ZTogJ0RyYWZ0JywgbGFiZWw6ICfstIjslYgnIH1cbiAgICBdO1xuXG4gICAgaXQoJ+yYteyFmOydhCDtkZzsi5ztlZzri6QnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxFZGl0YWJsZUNlbGxcbiAgICAgICAgICB2YWx1ZT1cIkFjdGl2ZVwiXG4gICAgICAgICAgdHlwZT1cInNlbGVjdFwiXG4gICAgICAgICAgb3B0aW9ucz17b3B0aW9uc31cbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgn7Zmc7ISxJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgn7YG066atIOyLnCDshYDroIntirjroZwg67OA6rK965Cc64ukJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8RWRpdGFibGVDZWxsXG4gICAgICAgICAgdmFsdWU9XCJBY3RpdmVcIlxuICAgICAgICAgIHR5cGU9XCJzZWxlY3RcIlxuICAgICAgICAgIG9wdGlvbnM9e29wdGlvbnN9XG4gICAgICAgICAgb25TYXZlPXttb2NrT25TYXZlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgZGlzcGxheUVsZW1lbnQgPSBzY3JlZW4uZ2V0QnlUZXh0KCftmZzshLEnKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhkaXNwbGF5RWxlbWVudCk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKCdjb21ib2JveCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ+qwkiDrs4Dqsr0g7IucIOyggOyepeuQnOuLpCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEVkaXRhYmxlQ2VsbFxuICAgICAgICAgIHZhbHVlPVwiQWN0aXZlXCJcbiAgICAgICAgICB0eXBlPVwic2VsZWN0XCJcbiAgICAgICAgICBvcHRpb25zPXtvcHRpb25zfVxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGRpc3BsYXlFbGVtZW50ID0gc2NyZWVuLmdldEJ5VGV4dCgn7Zmc7ISxJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soZGlzcGxheUVsZW1lbnQpO1xuXG4gICAgICBjb25zdCBzZWxlY3QgPSBzY3JlZW4uZ2V0QnlSb2xlKCdjb21ib2JveCcpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShzZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnSW5hY3RpdmUnIH0gfSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja09uU2F2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0luYWN0aXZlJyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ+yytO2BrOuwleyKpCDtg4DsnoUnLCAoKSA9PiB7XG4gICAgaXQoJ+yytO2BrOuwleyKpOulvCDtkZzsi5ztlZzri6QnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxFZGl0YWJsZUNlbGxcbiAgICAgICAgICB2YWx1ZT17dHJ1ZX1cbiAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGNoZWNrYm94ID0gc2NyZWVuLmdldEJ5Um9sZSgnY2hlY2tib3gnKTtcbiAgICAgIGV4cGVjdChjaGVja2JveCkudG9CZUNoZWNrZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCfssrTtgazrsJXsiqQg67OA6rK9IOyLnCDsoIDsnqXrkJzri6QnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxFZGl0YWJsZUNlbGxcbiAgICAgICAgICB2YWx1ZT17dHJ1ZX1cbiAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGNoZWNrYm94ID0gc2NyZWVuLmdldEJ5Um9sZSgnY2hlY2tib3gnKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhjaGVja2JveCk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja09uU2F2ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZmFsc2UpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfruYTtmZzshLHtmZQg7IOB7YOcJywgKCkgPT4ge1xuICAgIGl0KCdkaXNhYmxlZCDsi5wg7YG066at7ZW064+EIO2OuOynkeuQmOyngCDslYrripTri6QnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxFZGl0YWJsZUNlbGxcbiAgICAgICAgICB2YWx1ZT1cIu2FjOyKpO2KuCDsoJzrqqlcIlxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgZGlzYWJsZWQ9e3RydWV9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBkaXNwbGF5RWxlbWVudCA9IHNjcmVlbi5nZXRCeVRleHQoJ+2FjOyKpO2KuCDsoJzrqqknKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhkaXNwbGF5RWxlbWVudCk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeURpc3BsYXlWYWx1ZSgn7YWM7Iqk7Yq4IOygnOuqqScpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCfthYzsiqTtirgg7KCc66qpJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfsoIDsnqUg7ZGc7IucJywgKCkgPT4ge1xuICAgIGl0KCfsoIDsnqUg7KSRIO2RnOyLnOulvCDrs7Tsl6zspIDri6QnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxFZGl0YWJsZUNlbGxcbiAgICAgICAgICB2YWx1ZT1cIu2FjOyKpO2KuCDsoJzrqqlcIlxuICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBkaXNwbGF5RWxlbWVudCA9IHNjcmVlbi5nZXRCeVRleHQoJ+2FjOyKpO2KuCDsoJzrqqknKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhkaXNwbGF5RWxlbWVudCk7XG5cbiAgICAgIGNvbnN0IGlucHV0ID0gc2NyZWVuLmdldEJ5RGlzcGxheVZhbHVlKCfthYzsiqTtirgg7KCc66qpJyk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGlucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ+yDiCDsoJzrqqknIH0gfSk7XG4gICAgICBmaXJlRXZlbnQua2V5RG93bihpbnB1dCwgeyBrZXk6ICdFbnRlcicgfSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgn7KCA7J6l65CoJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTsgIl0sInZlcnNpb24iOjN9