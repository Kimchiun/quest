{"file":"/Users/3i-a1-2021-017/Documents/quest/Desktop/quest/src/main/app/domains/users/middleware/rbacMiddleware.ts","mappings":";;AAGA,kCAQC;AARD,SAAgB,WAAW,CAAC,KAAiB;IACzC,OAAO,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;QACvD,MAAM,IAAI,GAAI,GAAW,CAAC,IAAI,CAAC;QAC/B,IAAI,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;YACtC,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC,CAAC;QAC1D,CAAC;QACD,IAAI,EAAE,CAAC;IACX,CAAC,CAAC;AACN,CAAC","names":[],"sources":["/Users/3i-a1-2021-017/Documents/quest/Desktop/quest/src/main/app/domains/users/middleware/rbacMiddleware.ts"],"sourcesContent":["import { Request, Response, NextFunction } from 'express';\nimport { UserRole } from '../models/User';\n\nexport function requireRole(roles: UserRole[]) {\n    return (req: Request, res: Response, next: NextFunction) => {\n        const user = (req as any).user;\n        if (!user || !roles.includes(user.role)) {\n            return res.status(403).json({ message: '권한이 없습니다.' });\n        }\n        next();\n    };\n} "],"version":3}